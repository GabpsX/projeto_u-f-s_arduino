<!DOCTYPE html>
<html lang="pt-br">
<head>
  <!--boo-->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free Web tutorials">
    <meta name="keywords" content="HTML,CSS,XML,JavaScript">
    <link rel="stylesheet" href="css/style.css">
    <link href="css/bootstrap.css" rel="stylesheet">
    <title>GabpsX</title>
</head>
<style>

#back-to-top:hover{
  opacity: 0.8;
  background-color: rgb(5, 155, 255);
}

section{
    -webkit-font-smoothing: antialiased;
}


header a img{
    width: 16%;
	  height: 16%;
    margin-top: 2px;
    margin-bottom: 2px;
    margin-right: 5px;
    border-radius: 0.4cm;
    
    
}
header:hover a img {
	-moz-transform: scale(0.9);
	-webkit-transform: scale(0.9);
	transform: scale(1.2);
	max-width: 100%;
	-moz-transition: all 0.9s;
	-webkit-transition: all 0.9s;
	transition: all 0.9s;
  background: #1f1f1f;
}

header ul li a:hover {
	-moz-transform: scale(0.9);
	-webkit-transform: scale(0.9);
	transform: scale(1.2);
	max-width: 100%;
	-moz-transition: all 0.9s;
	-webkit-transition: all 0.9s;
	transition: all 0.9s;
}

a {
  color: rgb(255, 255, 255);
  text-decoration: none;
  font-family: 'Segoe UI', Tahoma, Verdana, sans-serif;
  margin-top: 10px;
}

a:hover {
  background: rgba(0, 0, 0, 0.05);
}

#logo {
  font-size: 1.5rem;
  font-weight: bold;
}

#header {
  box-sizing: border-box;
  height: 60px;
  padding: 1rem;
  display: flex;
  margin-left: auto;
  margin-right: auto;
  justify-content: space-between;
  background: #000000;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin-bottom: 0.08cm;
  width: 99%;
  border-bottom-right-radius: 8px;
  border-bottom-left-radius: 8px;
  align-items: center;
}

#menu {
  display: flex;
  list-style: none;
  gap: 1.0rem;
}

#menu a {
  display: block;
  padding: 0.5rem;
}

#btn-mobile {
  display: none;
}

@media (max-width: 600px) {
  #menu {

    position: fixed;
    display: inline-block;
    vertical-align: middle;
    width: 40vh;
    top: 70px;
    right: 10%;
    background: #ececec;
    transition: 0.8s;
    z-index: 1000;
    height: 0px;
    visibility: hidden;
    overflow-y: hidden;
    text-align: center;
    font-family: 'Segoe UI', Tahoma, Verdana, sans-serif;
    color:rgb(27, 27, 226);
  }
  #nav.active #menu {
    height: calc(100vh - 50vh);
    background-color: #1f1f1f;
    border-radius: 15px;
    visibility: visible;
    overflow-y: auto;

  }
  #menu a {
    padding: 0rem -10rem;
    margin: 1rem;
    border-radius: 10px;

    margin-right: 45px;
  }
  #btn-mobile {
    display: flex;
    padding: 0.5rem 1rem;
    font-size: 1rem;
    border: none;
    background: none;
    cursor: pointer;
    gap: 0.1rem;
  }
  #hamburger::after,
  #hamburger::before {
    content: '';
    display: block;
    width: 20px;
    height: 2px;
    background: currentColor;
    margin-top: 5px;
    transition: 0.2s;
    position: relative;
    background-color: rgb(255, 254, 254);

  }
  #nav.active #hamburger {
    border-top-color: transparent;

  }
  #nav.active #hamburger::before {
    transform: rotate(130deg);
  }
  #nav.active #hamburger::after {
    transform: rotate(-135deg);
    top: -1px;
  }
}
</style>
<body>
 
<header id="header">
      <a  href="index.html"><img src="https://raw.githubusercontent.com/GabpsX/GabpsX/a488afe575e5a193d5a22f85ef60cba16d7d1251/docs/icons8-github.gif" alt="Logo"></a>
      <nav id="nav">
         <button aria-label="Abrir Menu" id="btn-mobile" aria-haspopup="true" aria-controls="menu" aria-expanded="false">
         <span id="hamburger"></span>
         </button>
         <ul id="menu" role="menu">
            <li><a href="index.html">Arduino</a></li>
            <li><a href="/">Fritzing</a></li>
            <li><a href="/">Login</a></li>
            <li><a href="/">Sobre</a></li>
         </ul>
      </nav>
</header>    
<section class="disable">
</div>

<div id="carouselExampleDark" class="carousel carousel-dark slide" data-bs-ride="carousel">
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
    <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="1" aria-label="Slide 2"></button>
    <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="2" aria-label="Slide 3"></button>
  </div>
  <div class="carousel-inner">
    <div class="carousel-item active" data-bs-interval="10000">

        <img src="https://raw.githubusercontent.com/GabpsX/projeto_u-f-s_arduino/f6b0a4d7a538af88bb7385b62c3a9c3b8e30fe08/docs/img/pHmeter.png
" class="d-block w-100" alt="">
        
      
      <div class="carousel-caption d-none d-md-block">
        <h5>First slide label</h5>
        <p>Some representative placeholder content for the first slide.</p>
      </div>

    </div>
    <div class="carousel-item" data-bs-interval="2000">
      <img src="https://raw.githubusercontent.com/GabpsX/projeto_u-f-s_arduino/f6b0a4d7a538af88bb7385b62c3a9c3b8e30fe08/docs/img/pHmeter_2.png" class="d-block w-100" alt="">
      <div class="carousel-caption d-none d-md-block">
        <h5>Second slide label</h5>
        <p>Some representative placeholder content for the second slide.</p>
      </div>
    </div>

    <div class="carousel-item">
      <img src="https://raw.githubusercontent.com/GabpsX/projeto_u-f-s_arduino/f6b0a4d7a538af88bb7385b62c3a9c3b8e30fe08/docs/img/pHmeter_3.png" class="d-block w-100" alt="...">
      <div class="carousel-caption d-none d-md-block">
        <h5>Third slide label</h5>
        <p>Some representative placeholder content for the third slide.</p>
      </div>
    </div>
  </div>

  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>
</section>

    <div class="container-fluid p-5 bg-primary text-white text-center">
        <h1 style="font-size: 1.2em;" class="text-center">Desenvolvimento de instrumentação científica de baixo custo com a plataforma Arduino e impressão 3D</h1> 
        <h1 style="font-size: 1.0em; border: #1f1f1f;padding:8px;">Downloads</h1>
        <button id="button_1" type="button">Tutoriais</button>
      </div>

		</div>
	</div>
</div>

<div class="container-top_nav" style="background-color: #f7f6f6;
border-radius: 5px;
width: 98%;
margin-left: auto;
margin-top: 0.1cm;
margin-bottom: 0.1cm;
margin-right: auto;">
  <hr>
</div>
<section>
  <section class="container_1">
    <h3>Ciclador de Baterias</h3>
    <textarea id="Ciclador_copy">
	    /*REMOVER BIBLIOTECA - DISPLAY I2C NO FINAL*/

//sdcard
#include <SD.h>
#include <SPI.h>

// ========================================DS3231======================================================
// --- Bibliotecas Auxiliares ---
/*

  DS3231    -> Arduino UNO
  -----------------------------------------
  VCC pin   -> Analógico 2 (utilizado como digital 17)
  GND pin   -> Analógico 3 (utilizado como digital 16)
  SDA pin   -> Analógico 4 (SDA)
  SCL pin   -> Analógico 5 (SCL)

*/
#include <DS3231.h>          //Inclui a biblioteca do DS3231 Shield


// ====================================================================================================
// --- Mapeamento de Hardware ---
#define    vcc    17
#define    gnd    16


// ====================================================================================================
// --- Declaração de Objetos ---
DS3231  rtc(SDA, SCL);
Time t;
int horas, ano, minutos;


// ===========================================DS3231===================================================


File myFile;

int pinCS = 10; // Pin 10 on Arduino Uno -> 53




/* remover comentário - > only works with arduino mega
  #include "Nextion.h"

  //id pagina, id componente, nome componente

  NexWaveform s0 = NexWaveform(1, 1, "wave_form");
  //add nextext page 0
*/

//====================================================

/*===============NEXTION===============*/
//============INTERFACE GRÁFICA====ARDUINO NANO====
//biblioteca
#include <Nextion.h>
//criar objeto
//ID PAGE, ID COMPONENT, NAME
NexDSButton button_1 = NexDSButton(0, 1, "MODIFICAR");
NexTouch *nex_listen_list[] =
{
  //events that will be expected by the serial interface.
  &button_1,
  NULL
};
//button storage variable.
uint32_t number;



#include <Wire.h>
#include <Adafruit_MCP4725.h>
#include <Adafruit_INA219.h>
#include <LiquidCrystal_I2C.h>

LiquidCrystal_I2C lcd(0x3F, 20, 4);
Adafruit_INA219 ina219(0X40);
Adafruit_MCP4725 dac;

const int Q2 = 8;
const int Q3 = 9;
const int anal00 = A0;
const int anal01 = A1;
int anal00value = 0;
int anal01value = 0;
float anal00output = 0.0;
float anal01output = 0.0;
float current = 0.0;

int btflag = 0;

// medida de corrente
float voltage_V = 0, shuntVoltage_mV, busVoltage_V;
float current_mA = 0;
float power_mW = 0;
float energy_Wh = 0;
long time_s = 0;



void charge_discharge_battery()
{
  Serial.print("var_set_value: ");
  Serial.println(number);
  //cout << self.name <<endl;
  // HIGH Q3 --> CHARGE BATTERY
  // LOW Q2 --> CHARGE BATTERY

  //=====================

  // LOW Q3 --> DISCHARGE BATTERY
  // HIGH Q2 --> DISCHARGE BATTERY
  /*
    button_1.getValue(&number);
    if (number == 1) {
    //CHARGE BATTERY
    digitalWrite(Q3, HIGH); // P - CHANNEL
    digitalWrite(Q2, LOW); // N -  CHANNEL
    }
    else {
    //the value will be stored in the variable -> so if this value be equal 0 (number==0)(the battery will be discharged)
    //DISCHARGE BATTERY
    digitalWrite(Q3, LOW); // P - CHANNEL
    digitalWrite(Q2, HIGH); // N -  CHANNEL
    }
  */
  digitalWrite(Q3, HIGH); // P - CHANNEL
  digitalWrite(Q2, LOW); // N -  CHANNEL
}



// Amplifier
const int Rsense = 10;


//===================================================


void setup() {
  Serial.begin(9600);
  //DS3231

  pinMode(vcc, OUTPUT);
  pinMode(gnd, OUTPUT);
  digitalWrite(vcc, HIGH);
  digitalWrite(gnd,  LOW);
  rtc.begin();

  //SD
  pinMode(pinCS, OUTPUT);
  //SD
  //Nextion --> dac
  nexInit();
  dac.begin(0x60);
  // INA 219
  ina219.begin();
  ina219.setCalibration_32V_1A();
  // ina219.setCalibration_16V_400mA();
  pinMode(Q2, OUTPUT);
  pinMode(Q3, OUTPUT);
  pinMode(anal00, INPUT);
  pinMode(anal01, INPUT);

  // LCD
  lcd.init();                      // initialize the lcd
  lcd.backlight();//Power on the back light
}
// class
class var {
  public:
    void read_All();
    void writing_sd_card();
    void wave_form();
    void get_data_from_display();
};


/*======*/
String data_from_display = "";
String corrente_display;
String pot_corte_superior;
String pot_corte_inferior;

/*var*/
double corrente_display_doub;
double pot_cot_sup;
double pot_cot_inf;

/**/
void var::get_data_from_display() {
  if (Serial2.available()) {
    delay(30);
    while (Serial2.available()) {
      data_from_display += char(Serial2.read());
    }
    Serial.println(data_from_display);
  }
  if (data_from_display.substring(0, 4) == "corrente") {
    /*
      Serial.println("pot_corte_superior" + String(data_from_display.substring(4)));
      corrente_display
    */
    corrente_display = data_from_display.substring(4);
    corrente_display_doub = corrente_display.toDouble();
  }
  if (data_from_display.substring(0, 5) == "pot_sup") {
    /*
      Serial.println("pot_corte_inferior" + String(data_from_display.substring(5)));
    */
    pot_corte_superior = data_from_display.substring(5);
    pot_cot_sup = pot_corte_superior.toDouble();
  }

  if (data_from_display.substring(0, 5) == "pot_inf") {
    /*
      Serial.println("count is" + String(data_from_display.substring(5)));
    */
    pot_corte_inferior = data_from_display.substring(5);
    pot_cot_inf = pot_corte_inferior.toDouble();
  }
  data_from_display = "";
}
/*======*/

void var::read_All() {
  //função principal
  nexLoop(nex_listen_list);
  charge_discharge_battery();

  // setando a corrente através de potenciometro
  anal00value = analogRead(anal00);
  anal00output = map(anal00value, 0, 1023, 0, 400);
  current = anal00output;
  // Calculate required voltage drop over Rsense
  float setVoltage = current * Rsense / 1000;

  // Set DAC Value
  int dacValue = setVoltage / 5 * 4096; // 2^12
  if (dacValue > 4095 || dacValue < 0)
  {
    Serial.println("Error: specified value is out of range");
  }
  else
  {
    dac.setVoltage(dacValue, false);
  }

  // Leitura de voltagem através de porta A1
  anal01value = analogRead(anal01);
  float voltagem = map(anal01value, 0, 1023, 0, 5);

  // LEITURA DE POTENCIAL E CORRENTE
  // INA219 medida de corrente
  float shuntvoltage = 0;
  float busvoltage = 0;
  float current_mA = 0;
  float loadvoltage = 0;
  float power_mW = 0;


  time_s = millis() / (1000); // convert time to sec
  busVoltage_V = ina219.getBusVoltage_V();
  shuntVoltage_mV = ina219.getShuntVoltage_mV();
  voltage_V = busVoltage_V + (shuntVoltage_mV / 1000);
  current_mA = ina219.getCurrent_mA();
  //power_mW = ina219.getPower_mW();
  power_mW = current_mA * voltage_V;
  energy_Wh = (power_mW * time_s) / 3600;
  Serial.print("ina 219:  ");
  Serial.println(current_mA);


  lcd.setCursor(0, 0);
  lcd.print("I (set): ");
  lcd.setCursor(9, 0);
  lcd.print(current, 3);
  lcd.setCursor(18, 0);
  lcd.print("mA");

  lcd.setCursor(0, 1);
  lcd.print("I(mAmp): ");
  lcd.setCursor(9, 1);
  lcd.print(current_mA, 3);
  lcd.setCursor(18, 1);
  lcd.print("mA");


  lcd.setCursor(0, 2); //we start writing from the first row first column
  lcd.print("Sunt V:"); //16 characters poer line
  lcd.setCursor(9, 2);
  lcd.print(shuntVoltage_mV, 3);
  lcd.setCursor(19, 2);
  lcd.print("V");

  lcd.setCursor(0, 3); //we start writing from the first row first column
  lcd.print("A1 volt :"); //16 characters poer line
  lcd.setCursor(9, 3);
  lcd.print(voltagem, 3);
  lcd.setCursor(10, 3);
  lcd.setCursor(19, 3);
  lcd.print("V");
  delay(100);

}


void var::wave_form() {
  /*
    //1 ciclo

    s0.addValue(0, self.pot );// channel 0

    //2 ciclo

    s0.addValue(1, self.pot );// channel 1

    //3 ciclo

    s0.addValue(2, self.pot );// channel 2

    //4 ciclo

    s0.addValue(3, self.pot );// channel 3
  */
}


//sdcard
void var::writing_sd_card() {
  // SD Card Initialization
  if (SD.begin())
  {
    Serial.println("SD card is ready to use.");
  } else
  {
    Serial.println("SD card initialization failed");
    return;
  }

  // Create/Open file
  myFile = SD.open("test12.txt", FILE_WRITE);


  //=============
  //comentar as requisições caso o shield DS3231 não esteja conectado -> do contrário o código não será executado da maneira correta
  //para salvar os valores informados pelo shield DS3231, adicionar o nome da variavel na estrutura de condição abaixo.
  t = rtc.getTime();
  horas = t.hour;
  ano   = t.year;
  minutos = t.min;
  //=============


  // if the file opened okay, write to it:
  if (myFile) {
    Serial.println("Writing to file...");
    // Write to file -> (adicionar colunas) - print_in_line
    myFile.print("corrente:");
    myFile.print(corrente_display_doub);
    myFile.print(", ");

    myFile.print("potencial_de_corte_superior:");
    myFile.print(pot_cot_sup);
    myFile.print(", ");

    myFile.print("potencial_de_corte_inferior:");
    myFile.print(pot_cot_inf);
    myFile.print(", ");

    myFile.print("horas ");
    myFile.print(horas);
    myFile.print(", ");

    myFile.print("minutos: ");
    myFile.print(minutos);
    myFile.print(", ");

    myFile.print("ano: ");
    myFile.println(ano);
    //print in line na última saida

    myFile.close(); // close the file
    Serial.println("Done.");
  }
  // if the file didn't open, print an error:
  else {
    Serial.println("error opening test.txt");
  }

  // Reading the file
  myFile = SD.open("test12.txt");
  if (myFile) {
    Serial.println("Read:");
    // Reading the whole file
    while (myFile.available()) {
      Serial.write(myFile.read());
    }
    myFile.close();
  }
  else {
    Serial.println("error opening test.txt");
  }
}

void loop() {
  var object; // creating object
  object.read_All(); // call method
  object.get_data_from_display(); //call method
  object.writing_sd_card();// call method
  delay(1000);
}
	  
  </textarea>
  
  </section>
  <br>
  <div class="text-center">
    <button id="button" type="button"  value="Copy">Copy Code</button>
    <button id="button_2" type="button" onclick="location.href='https://github.com/GabpsX/Ciclador_bat/archive/refs/heads/main.zip'" type="button">
      Download</button>
    <script type="text/javascript">
        var button1 = document.getElementById("button"),
            input1 = document.getElementById("Ciclador_copy");

        button1.addEventListener("click", function(event1) {
            event1.preventDefault();
            input1.select();
            document.execCommand("copy");
        });
    </script>
  </div>

  <br>
  <hr>
  <section class="container_2">
    <h3>pHmetro</h3>
    <textarea id="ph_copy">//GABRIEL P.S
      //V: 5.1 >> pHmetro
      #include <Nextion.h>
      #include <EEPROM.h>
      //sensor temperatura
      #include <OneWire.h>
      #include <DallasTemperature.h>
      // O fio de dados é conectado no pino digital 2 no Arduino
      #define ONE_WIRE_BUS 2
      // Prepara uma instância oneWire para comunicar com qualquer outro dispositivo oneWire
      OneWire oneWire(ONE_WIRE_BUS);
      // Passa uma referência oneWire para a biblioteca DallasTemperature
      DallasTemperature sensors(&oneWire);
      #include <LinearRegression.h>
      //update //
      class tempr {
        public:
          float temperature;
      };
      //===========================================================//
      const int analogInPin = A0;
      int current_page = 0;
      int buf[10], temp;
      
      //===========================================================//
      
      
      #define    pot    A0   //potenciômetro na analógica 0
      
      #define    led    13   //led onboard pino digital 13
      
      //Calibração
      //========page0========
      //É necessário adicionar botao na inteface gráfica, para funcionar.
      NexDSButton calib1 = NexDSButton(0, 1, "calib1");
      //simbolo.
      NexText  nothing = NexText(0, 8, "graus");
      // imprime na tela o valor imformado pelo eletrodo, sonda de ph.
      NexText  valorph = NexText(0, 3, "phvar");
      // imprime na tela o valor imformado pelo sensor de temperatura.
      NexText  valortemp = NexText(0, 2, "temp");
      //
      NexScrolltext scrolltext = NexScrolltext(0, 7, "g0");
      
      //OK
      //========page1========
      
      //OK
      //========page2========
      
      //OK
      
      //===========================Calibração com 3 pontos==========================
      //========page3========
      //Texto
      NexText  ponto_1_page3 = NexText(3, 4, "volt1_page3");
      
      //========page4========
      
      //OK
      
      //========page5========
      //Texto
      NexText  ponto_1_page5 = NexText(5, 5, "pon_1ok");
      NexText  ponto_2_page5 = NexText(5, 4, "volt2_page5");
      
      //========page6========
      
      //OK
      
      //========page7========
      //Texto
      
      NexText  coe__angu1_page7 = NexText(7, 5, "coe__angu1");
      
      NexText  ponto_3_page7 = NexText(7, 4, "volt3_page7");
      
      //========page8========
      //Texto
      
      NexText  coe_angu1_page8 = NexText(8, 4, "coe_angu1");
      
      NexText  coe_linear1_page8 = NexText(8, 5, "coe_linear1");
      
      //===========================F 3 pontos==========================
      
      //===========================Calibração com 2 pontos (meio alcalino)==========================
      //========page9========
      
      //OK
      //========page10========
      //Texto
      
      NexText  volt_1_page10 = NexText(10, 4, "volt1_page10");
      
      //========page11========
      
      //OK
      //========page12========
      //Texto
      
      NexText  volt_1_page12 = NexText(12, 4, "volt1_page12");
      NexText  coe_angu1_page12 = NexText(12, 5, "coe__angu2");
      
      
      //========page13========
      //Texto
      
      NexText  coe_angu1_page13 = NexText(13, 4, "coe_angu2");
      NexText  coe_linear1_page13 = NexText(13, 5, "coe_linear2");
      
      
      //===========================F 2 pontos (meio alcalino)==========================
      
      //===========================Calibração com 2 pontos (meio ácido)==========================
      //========page14========
      
      //OK
      //========page15========
      //Texto
      
      NexText  volt_1_page15 = NexText(15, 4, "volt1_page15");
      
      
      
      //========page16========
      
      //OK
      //========page17========
      //Texto
      
      NexText  coe_angu1_page17 = NexText(17, 5, "coe_angu3");
      NexText  volt_1_page17 = NexText(17, 4, "volt1_page17");
      
      
      //========page18========
      //Texto
      
      NexText  coe_angu1_page18 = NexText(18, 4, "coe__angu3");
      NexText  coe_linear1_page18 = NexText(18, 5, "coe_linear3");
      
      
      
      // --- Variáveis Globais ---
      float   pot_value = 0;    //valor ad do potenciômetro ou sensor de temp
      
      
      char    txt[10];         //texto para conversão e exibição
      float   pHVol;
      
      
      
      
      
      //variaveis (meioacido) , (alcalino) e 3 pontos
      float salvarponto1 = 0.00;
      float salvarponto2 = 0.00;
      float salvarponto3 = 0.00;
      LinearRegression lr = LinearRegression();
      float r, a, b, n;  // coeficientes da correlação
      
      //=======salvar os coeficientes =========
      float pontom = 30;
      float pontob = 35;
      
      void quebra_linha() {
      
        Serial.println();
      }
      
      void pH() {
        unsigned long int avgValue;
        for (int i = 0; i < 10; i++)
        {
          buf[i] = analogRead(analogInPin);
        }
        for (int i = 0; i < 9; i++)
        {
          for (int j = i + 1; j < 10; j++)
          {
            if (buf[i] > buf[j])
            {
              temp = buf[i];
              buf[i] = buf[j];
              buf[j] = temp;
            }
          }
        }
        avgValue = 0;
        for (int i = 2; i < 8; i++)
          avgValue += buf[i];
        pHVol = (float)avgValue * 5.0 / 1024 / 6;
      }
      
      
      // pages
      NexPage page0 = NexPage(0, 0, "page0");  // Page added as a touch event
      NexPage page1 = NexPage(1, 0, "page1");  // Page added as a touch event
      NexPage page2 = NexPage(2, 0, "page2");  // Page added as a touch event
      NexPage page3 = NexPage(3, 0, "page3");  // Page added as a touch event
      NexPage page4 = NexPage(4, 0, "page4");  // Page added as a touch event
      NexPage page5 = NexPage(5, 0, "page5");  // Page added as a touch event
      NexPage page6 = NexPage(6, 0, "page6");  // Page added as a touch event
      NexPage page7 = NexPage(7, 0, "page7");  // Page added as a touch event
      NexPage page8 = NexPage(8, 0, "page8");  // Page added as a touch event
      NexPage page9 = NexPage(9, 0, "page9");  // Page added as a touch event
      
      //
      
      NexPage page21 = NexPage(21, 0, "page21");  // Page added as a touch event
      
      
      
      
      NexTouch *nex_listen_list[] =
      {
        &page0,
        &page1,
        &page2,
        &page3,
        &page4,
        &page5,
        &page6,
        &page7,
        &page8,
        &page9,
      
        &page21,
      
      
        NULL
      };
      
      //
      void page0PushCallback(void *ptr)
      {
        current_page = 0;
      }
      
      void page1PushCallback(void *ptr)
      {
        current_page = 1;
      }
      
      void page2PushCallback(void *ptr)
      {
        current_page = 2;
      }
      
      void page3PushCallback(void *ptr)
      {
        current_page = 3;
      }
      
      void page4PushCallback(void *ptr)
      {
        current_page = 4;
      }
      
      void page5PushCallback(void *ptr)
      {
        current_page = 5;
      }
      
      void page6PushCallback(void *ptr)
      {
        current_page = 6;
      }
      
      void page7PushCallback(void *ptr)
      {
        current_page = 7;
      }
      
      void page8PushCallback(void *ptr)
      {
        current_page = 8;
      }
      
      void page9PushCallback(void *ptr)
      {
        current_page = 9;
      }
      
      
      
      
      //
      void page10PushCallback(void *ptr)
      {
        current_page = 21;
      }
      
      
      // -------------=====================-------------------
      void homepage()
      {
        tempr self;
        pH();
        //valores
        float doangular;
        float dolinear;
        float varm = EEPROM.get(pontom, doangular );
        float varb = EEPROM.get(pontob, dolinear );
        Serial.print("varm = ");
        Serial.println(varm);
        Serial.print("varb = ");
        Serial.println(varb);
      
        Serial.print("volt = ");
        Serial.println(pHVol);
        //y = mx+b
        float pH1val = varm * pHVol + varb ;
        Serial.print("pH = ");
        Serial.println(pH1val);
      
        quebra_linha();
        //                      pH
        static char varph[5];
        dtostrf(pH1val , 2, 2, varph);
        valorph.setText(varph);
        //                                  temperatura
        sensors.requestTemperatures();
        self.temperature = sensors.getTempCByIndex(0);
        static char temp1[14];
        dtostrf(self.temperature , 2, 2, temp1);
        valortemp.setText(temp1);
      
        if (pH1val > 7.2 and pH1val < 15)
        {
          scrolltext.setText("Alcal...");
        }
        if (pH1val > 0 and pH1val < 7.2)
        {
          scrolltext.setText("Acid...");
        }
        if (pH1val > 6.8 and pH1val < 7.2)
      
        {
          scrolltext.setText("Neut...");
        }
      
      }
      
      double values[3];
      
      float pot1a;
      float pot2a;
      float pot3a;
      void calib2pontos_ponto1_meio_alcalino()
      //==============================******tampao pH 6.86 *********=====dois pontos meio alcalino
      {
        //Tela  7 /***********************************************************************************
        quebra_linha();
        digitalWrite(13, 1);
        //===================================================================
        show_pH_calib();
        pH();
        pot1a = pHVol;
        static char valorm1[5];
        dtostrf(pHVol , 2, 2, valorm1);
        volt_1_page10.setText(valorm1);
      
      }
      
      
      void calib2pontos_ponto2_meio_alcalino()
      {
        quebra_linha();
        //**********************************************************
        show_pH_calib();
        pH();
        pot2a = pHVol;
        static char ph7[5];
        dtostrf(pot2a , 2, 2, ph7);
        volt_1_page12.setText(ph7);
        LinearRegression lr = LinearRegression(0, 100);
        lr.learn(pot1a, 6.86);
        lr.learn(pot2a, 9.18);
        lr.getValues(values);
        r = lr.correlation();  // coef correlacao
        a = values [0];    // coef angular
        b = values [1];    // coef linear
        n = values [2];    // numero de pontos
      
        static char ph2[5];
        dtostrf(a , 2, 2, ph2);
        coe_angu1_page12.setText(ph2);
        //point x 1000 --> to save
        salvarponto1 = a * 1000;
        salvarponto2 = b * 1000;
      
      }
      
      void salvando_coeficientes_meio_alcalino()
      {
        EEPROM.put(pontom, a);
        EEPROM.put(pontob, b);
        quebra_linha();
        //Tela9 /*****************************************************************************************
        digitalWrite(13, 1);
        pH();
        float exibe_angular = salvarponto1 / 1000;
        float exibe_linear = salvarponto2 / 1000;
      
        static char ph40[14];
        dtostrf(exibe_angular  , 2, 2, ph40);
        coe_angu1_page13.setText(ph40);
      
        static char ph50[5];
        dtostrf(exibe_linear  , 2, 2, ph50);
        coe_linear1_page13.setText(ph50);
      
      }
      
      //****************************************************************************************
      void calib2pontos_ponto1_meio_acido()
      //==============================*********tampao pH 4.18 *********=====dois pontos meio acido
      {
        quebra_linha();
        digitalWrite(13, 1);
        //===================================================================
        show_pH_calib();
        pH();
        pot1a = pHVol;
        static char valorm1[5];
        dtostrf(pHVol , 2, 2, valorm1);
        volt_1_page15.setText(valorm1);
      
      }
      
      
      void calib2pontos_ponto2_meio_acido()
      {
        quebra_linha();
        //**********************************************************
        show_pH_calib();
        pH();
        pot2a = pHVol;
        static char ph7[5];
        dtostrf(pot2a , 2, 2, ph7);
        volt_1_page17.setText(ph7);
        LinearRegression lr = LinearRegression(0, 100);
        lr.learn(pot1a, 4.18);
        lr.learn(pot2a, 6.86);
        lr.getValues(values);
        r = lr.correlation();  // coef correlacao
        a = values [0];    // coef angular
        b = values [1];    // coef linear
        n = values [2];    // numero de pontos
      
        static char ph2[5];
        dtostrf(a , 2, 2, ph2);
        coe_angu1_page17.setText(ph2);
        //point x 1000 --> to save
        salvarponto1 = a * 1000;
        salvarponto2 = b * 1000;
      
      }
      
      void salvando_coeficientes_meio_acido()
      {
        EEPROM.put(pontom, a);
        EEPROM.put(pontob, b);
        quebra_linha();
        //*********************************************************
        digitalWrite(13, 1);
        pH();
        float exibe_angular = salvarponto1 / 1000;
        float exibe_linear = salvarponto2 / 1000;
      
        static char ph40[14];
        dtostrf(exibe_angular  , 2, 2, ph40);
        coe_angu1_page18.setText(ph40);
      
        static char ph50[5];
        dtostrf(exibe_linear  , 2, 2, ph50);
        coe_linear1_page18.setText(ph50);
      
      }
      
      
      
      //****************************************************************************************
      
      
      void setup() {
        // put your setup code here, to run once:
        nexInit();
        sensors.begin();
        Serial.begin(57600);
        page21.attachPush(page10PushCallback);
        //
        page0.attachPush(page0PushCallback);
        page1.attachPush(page1PushCallback);
        page2.attachPush(page2PushCallback);
        page3.attachPush(page3PushCallback);
        page4.attachPush(page4PushCallback);
        page5.attachPush(page5PushCallback);
        page6.attachPush(page6PushCallback);
        page7.attachPush(page7PushCallback);
        page8.attachPush(page8PushCallback);
        page9.attachPush(page9PushCallback);
      
      
      
      }
      //----------------------------------calibração de 3 pontos
      void calib3pontos_ponto1()
      //==============================********* tampao pH 4.18 *********=====3 pontos
      {
        //Tela  2 /***********************************************************************************
        quebra_linha();
        digitalWrite(13, 1);
        //===================================================================
        show_pH_calib();
        pH();
        pot1a = pHVol;
        static char valorm1[5];
        dtostrf(pHVol , 2, 2, valorm1);
        ponto_1_page3.setText(valorm1);
      
      }
      void calib3pontos_ponto2()
      //==============================*********SCREEN 3==> tampao pH 6.86 *********=====3 pontos
      {
        //Tela  3 /***********************************************************************************
        quebra_linha();
        digitalWrite(13, 1);
        //===================================================================
        show_pH_calib();
        pH();
      
        pot2a = pHVol;
      
      
        static char val_[5];
        dtostrf(pot1a  , 2, 2, val_);
        ponto_1_page5.setText(val_);
      
        static char valorm1[5];
        dtostrf(pot2a , 2, 2, valorm1);
        ponto_2_page5.setText(valorm1);
      }
      
      
      void calib3pontos_ponto3()
      //==============================*********SCREEN 4==> tampao pH 9.18 *********=====3 pontos
      {
        //Tela  4 /***********************************************************************************
        quebra_linha();
        digitalWrite(13, 1);
        //===================================================================
        show_pH_calib();
        pH();
        pot3a = pHVol;
      
        static char ph7[5];
        dtostrf(pot3a , 2, 2, ph7);
        ponto_3_page7.setText(ph7);
      
        LinearRegression lr = LinearRegression(0, 100);
        lr.learn(pot1a, 4.18);
        lr.learn(pot2a, 6.86);
        lr.learn(pot3a, 9.18);
        lr.getValues(values);
        r = lr.correlation();  // coef correlacao
        a = values [0];    // coef angular
        b = values [1];    // coef linear
        n = values [2];    // numero de pontos
      
        static char ph2[5];
        dtostrf(a , 2, 2, ph2);
        coe__angu1_page7.setText(ph2);
        //point x 1000 --> to save
        salvarponto1 = a * 1000;
        salvarponto2 = b * 1000;
      
      
      
      }
      void salvando_os_coeficientes_3pontos()
      //==============================*********SCREEN 5
      {
        //Tela  5 /***********************************************************************************
        quebra_linha();
        digitalWrite(13, 1);
        //===================================================================
        EEPROM.put(pontom, a);
        EEPROM.put(pontob, b);
        pH();
        float exibe_angular = salvarponto1 / 1000;
        float exibe_linear = salvarponto2 / 1000;
      
        static char ph40[14];
        dtostrf(exibe_angular  , 2, 2, ph40);
        coe_angu1_page8.setText(ph40);
      
        static char ph50[5];
        dtostrf(exibe_linear  , 2, 2, ph50);
        coe_linear1_page8.setText(ph50);
      
      }
      
      
      //------------------------------------------
      
      NexText  pH1 = NexText(1, 4, "pH1");
      NexText  pH2 = NexText(2, 5, "pH2");
      NexText  pH3 = NexText(3, 5, "pH3");
      
      NexText  pH4 = NexText(5, 4, "pH4");
      NexText  pH5 = NexText(6, 5, "pH5");
      
      NexText  pH6 = NexText(8, 4, "pH6");
      NexText  pH7 = NexText(9, 5, "pH7");
      void show_pH_calib() {
        if (current_page == 1) { //////////////////page
          pH();
          //valores
          float doangular;
          float dolinear;
          float varm = EEPROM.get(pontom, doangular );
          float varb = EEPROM.get(pontob, dolinear );
          float pH1val = varm * pHVol + varb ;
      
          static char ph40[5];
          dtostrf(pH1val  , 2, 2, ph40);
          pH1.setText(ph40);
        }
        if (current_page == 2) { //////////////////page
          pH();
          //valores
          float doangular;
          float dolinear;
          float varm = EEPROM.get(pontom, doangular );
          float varb = EEPROM.get(pontob, dolinear );
          float pH1val = varm * pHVol + varb ;
      
          static char ph40[5];
          dtostrf(pH1val  , 2, 2, ph40);
          pH2.setText(ph40);
        }
        if (current_page == 3) { //////////////////page
          pH();
          //valores
          float doangular;
          float dolinear;
          float varm = EEPROM.get(pontom, doangular );
          float varb = EEPROM.get(pontob, dolinear );
          float pH1val = varm * pHVol + varb ;
      
          static char ph40[5];
          dtostrf(pH1val  , 2, 2, ph40);
          pH3.setText(ph40);
        }
        if (current_page == 5) { //////////////////page
          pH();
          //valores
          float doangular;
          float dolinear;
          float varm = EEPROM.get(pontom, doangular );
          float varb = EEPROM.get(pontob, dolinear );
          float pH1val = varm * pHVol + varb ;
      
          static char ph40[5];
          dtostrf(pH1val  , 2, 2, ph40);
          pH4.setText(ph40);
        }
        if (current_page == 6) { //////////////////page
          pH();
          //valores
          float doangular;
          float dolinear;
          float varm = EEPROM.get(pontom, doangular );
          float varb = EEPROM.get(pontob, dolinear );
          float pH1val = varm * pHVol + varb ;
      
          static char ph40[5];
          dtostrf(pH1val  , 2, 2, ph40);
          pH5.setText(ph40);
        }
        if (current_page == 8) { //////////////////page
          pH();
          //valores
          float doangular;
          float dolinear;
          float varm = EEPROM.get(pontom, doangular );
          float varb = EEPROM.get(pontob, dolinear );
          float pH1val = varm * pHVol + varb ;
      
          static char ph40[5];
          dtostrf(pH1val  , 2, 2, ph40);
          pH6.setText(ph40);
        }
        if (current_page == 9) { //////////////////page
          pH();
          //valores
          float doangular;
          float dolinear;
          float varm = EEPROM.get(pontom, doangular );
          float varb = EEPROM.get(pontob, dolinear );
          float pH1val = varm * pHVol + varb ;
      
          static char ph40[5];
          dtostrf(pH1val  , 2, 2, ph40);
          pH7.setText(ph40);
        }
      }
      void loop() {
        //3 pontos
        if (current_page == 0)//////////////////page
        {
          Serial.println("MEASURING pH");///////potentio meter value in gauge
      
          homepage();
        }
        if (current_page == 1)//////////////////page
        {
          Serial.println("CALIBRANDO PONTO 1 - 3 PONTOS");///////potentio meter value in gauge
          calib3pontos_ponto1();
        }
        if (current_page == 2)//////////////////page
        {
          Serial.println("CALIBRANDO PONTO 2 - 3 PONTOS");///////potentio meter value in gauge
          calib3pontos_ponto2();
        }
        if (current_page == 3)//////////////////page
        {
          Serial.println("CALIBRANDO PONTO 3 - 3 PONTOS");///////potentio meter value in gauge
          calib3pontos_ponto3();
      
        }
        if (current_page == 4)//////////////////page
        {
          Serial.println("FINALIZANDO CALIBRAÇÃO - 3 PONTOS");///////potentio meter value in gauge
          salvando_os_coeficientes_3pontos();
      
        }
      
      
        //meio alcalino
        if (current_page == 5)//////////////////page
        {
          Serial.println("CALIBRANDO PONTO 1 - 2 MEIO ALCALINO");///////potentio meter value in gauge
          calib2pontos_ponto1_meio_alcalino();
      
        }
        if (current_page == 6)//////////////////page
        {
          Serial.println("CALIBRANDO PONTO 2 - 2 MEIO ALCALINO");///////potentio meter value in gauge
          calib2pontos_ponto2_meio_alcalino();
      
        }
        if (current_page == 7)//////////////////page
        {
          Serial.println("FINALIZANDO CALIBRAÇÃO - 2 MEIO ALCALINO");///////potentio meter value in gauge
          salvando_coeficientes_meio_alcalino();
      
        }
      
      
        //meio acido
        if (current_page == 8)//////////////////page
        {
          Serial.println("CALIBRANDO PONTO 1 - 2 MEIO ACIDO");///////potentio meter value in gauge
          calib2pontos_ponto1_meio_acido();
      
        }
        if (current_page == 9)//////////////////page
        {
          Serial.println("CALIBRANDO PONTO 2 - 2 MEIO ACIDO");///////potentio meter value in gauge
          calib2pontos_ponto2_meio_acido();
      
        }
        //
        if (current_page == 21)//////////////////page
        {
          Serial.println("FINALIZANDO CALIBRAÇÃO - 2 MEIO ACICO");///////potentio meter value in gauge
          salvando_coeficientes_meio_acido();
        }
      
        nexLoop(nex_listen_list);
      }
      </textarea>
  
  </section>
  <br>
  <div class="text-center">
    <button id="button_3" type="button">Copy Code</button>
    <button id="button_4" type="button" onclick="location.href='https://github.com/GabpsX/pHmetro/archive/refs/heads/main.zip'" type="button">
      Download</button>
    <script type="text/javascript">
        var button = document.getElementById("button_3"),
            input = document.getElementById("ph_copy");

        button.addEventListener("click", function(event) {
            event.preventDefault();
            input.select();
            document.execCommand("copy");
        });
    </script>
  </div>
  <br>
<hr>
  <!-- Copyright -->
  <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
    © 2022 Copyright:
    <a class="text-white" href="">Developed by GabpsX.</a>
    <button id ="back-to-top" type="button" class="btn btn-success">Back to top</button>
  </div>
  <!-- Copyright -->
</footer>
<!-- Footer -->
       
    <script>
       var btn = document.querySelector("#back-to-top");
       btn.addEventListener("click", function() {
          window.scrollTo(0, 0);
       });
    </script>
 </section>
</body>
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/scripts.js"></script>
<script src="js/script_menu.js"></script>
<script src="/js/add_code.js"></script>
<script>
    function myFunction() {
      var x = document.getElementById("myLinks");
      if (x.style.display === "block") {
        x.style.display = "none";
      } else {
        x.style.display = "block";
      }
    }
</script>

</html>
